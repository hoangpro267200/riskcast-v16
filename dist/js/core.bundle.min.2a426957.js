(function(){'use strict';window.RiskCastData ={transport:{tradeLane: null, transportMode: null, route: null, pol: null, pod: null, departureDate: null, distance: null, transitTime: null}, cargo:{cargoType: null, packingType: null, grossWeight: null, volume: null, containerType: null, packages: null}, seller:{companyName: null, country: null, companySize: null, email: null, phone: null, personInCharge: null, reliability: null, riskLevel: null, esgScore: null}, buyer:{companyName: null, country: null, companySize: null, email: null, phone: null, personInCharge: null, reliability: null, riskLevel: null, esgScore: null}, advanced:{distance: null, routeType: null, carrier: null, carrierRating: null, weatherRisk: null, portRisk: null, containerMatch: null, shipmentValue: null, priority: null}, climate:{ensoIndex: null, typhoonFrequency: null, sstAnomaly: null, portClimateStress: null, climateVolatilityIndex: null, esgScore: null, climateResilience: null, greenPackaging: null}};window.RiskCastDataStore ={set: function(section, field, value){if (window.RiskCastData[section] && field in window.RiskCastData[section]){window.RiskCastData[section][field] = value;this.triggerUpdate(section, field, value);}}, get: function(section, field){if (window.RiskCastData[section] && field in window.RiskCastData[section]){return window.RiskCastData[section][field];}return null;}, update: function(section, data){if (window.RiskCastData[section]){Object.assign(window.RiskCastData[section], data);Object.keys(data).forEach(field =>{this.triggerUpdate(section, field, data[field]);});}}, triggerUpdate: function(section, field, value){const event = new CustomEvent('riskcastDataUpdate',{detail:{section, field, value}});document.dispatchEvent(event);}, syncFromInputs: function(){}, syncToInputs: function(section, field, value){}};})();function debounce(func, wait, immediate = false){let timeout;return function executedFunction(...args){const context = this;const later = () =>{timeout = null;if (!immediate) func.apply(context, args);};const callNow = immediate && !timeout;clearTimeout(timeout);timeout = setTimeout(later, wait);if (callNow) func.apply(context, args);};}function throttle(func, limit){let inThrottle;return function(...args){const context = this;if (!inThrottle){func.apply(context, args);inThrottle = true;setTimeout(() => inThrottle = false, limit);}};}function deepClone(obj){if (obj === null || typeof obj !== 'object'){return obj;}if (obj instanceof Date){return new Date(obj.getTime());}if (obj instanceof Array){return obj.map(item => deepClone(item));}if (typeof obj === 'object'){const cloned ={};for (const key in obj){if (obj.hasOwnProperty(key)){cloned[key] = deepClone(obj[key]);}}return cloned;}return obj;}function isEmpty(value){if (value === null || value === undefined){return true;}if (typeof value === 'string'){return value.trim() === '';}if (Array.isArray(value)){return value.length === 0;}if (typeof value === 'object'){return Object.keys(value).length === 0;}return false;}function generateId(){return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;}function sleep(ms){return new Promise(resolve => setTimeout(resolve, ms));}async function retry(fn, maxRetries = 3, delay = 1000){for (let i = 0;i < maxRetries;i++){try{return await fn();}catch (error){if (i === maxRetries - 1) throw error;await sleep(delay * Math.pow(2, i));}}}function formatNumber(num){if (num === null || num === undefined || isNaN(num)){return '0';}return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');}function parseNumber(str){if (typeof str !== 'string'){return Number(str) || 0;}return Number(str.replace(/[^\d.-]/g, '')) || 0;}function clamp(value, min, max){return Math.min(Math.max(value, min), max);}function batchDOMUpdates(callback){let scheduled = false;return function(...args){if (!scheduled){scheduled = true;requestAnimationFrame(() =>{callback.apply(this, args);scheduled = false;});}};}if (typeof window !== 'undefined'){window.RCUtils ={debounce, throttle, deepClone, isEmpty, generateId, sleep, retry, formatNumber, parseNumber, clamp, batchDOMUpdates};}(function(){'use strict';if (typeof window.RISKCAST === 'undefined'){window.RISKCAST ={};}if (typeof window.RISKCAST.core === 'undefined'){window.RISKCAST.core ={};}const TRANSLATIONS_VI ={brand_title: "RISKCAST v12.5", brand_subtitle: "N·ªÅn T·∫£ng Th√¥ng Minh Ph√¢n T√≠ch R·ªßi Ro Logistics ƒê∆∞·ª£c H·ªó Tr·ª£ B·ªüi AI", status_ready: "Ph√¢n T√≠ch Ho√†n T·∫•t", status_loading: "ƒêang t·∫£i d·ªØ li·ªáu...", tab_enterprise: "Ch·∫ø ƒê·ªô Doanh Nghi·ªáp", tab_research: "Ch·∫ø ƒê·ªô Ph√¢n T√≠ch NCKH", tab_investor: "Ch·∫ø ƒê·ªô Tr√¨nh B√†y Nh√† ƒê·∫ßu T∆∞", section_executive: "T·ªïng Quan ƒêi·ªÅu H√†nh", label_overall_risk: "Ch·ªâ s·ªë r·ªßi ro t·ªïng h·ª£p", label_expected_loss: "T·ªïn th·∫•t k·ª≥ v·ªçng", label_reliability: "ƒê·ªô tin c·∫≠y giao h√†ng", label_esg: "ƒêi·ªÉm ESG (M√¥i tr∆∞·ªùng ‚Äì X√£ h·ªôi ‚Äì Qu·∫£n tr·ªã)", subtitle_per_shipment: "M·ªói l√¥ h√†ng", subtitle_on_time_prob: "X√°c su·∫•t ƒë√∫ng h·∫°n", subtitle_climate_political: "Kh√≠ h·∫≠u + Ch√≠nh tr·ªã", label_top_route: "R·ªßi ro tuy·∫øn v·∫≠n t·∫£i l·ªõn nh·∫•t:", label_main_driver: "Nguy√™n nh√¢n ch√≠nh:", label_recommendation: "Khuy·∫øn ngh·ªã c·ªßa h·ªá th·ªëng:", section_risk_gauges: "T·ªïng Quan ƒê·ªìng H·ªì R·ªßi Ro", gauge_risk_title: "Ch·ªâ S·ªë R·ªßi Ro T·ªïng Th·ªÉ", gauge_reliability_title: "ƒêi·ªÉm ƒê·ªô Tin C·∫≠y", gauge_esg_title: "ƒêi·ªÉm ESG", gauge_explanations:{title: "Gi·∫£i Th√≠ch Chuy√™n S√¢u", risk_title: "Ch·ªâ S·ªë R·ªßi Ro T·ªïng Th·ªÉ", risk:{low: "M·ª©c r·ªßi ro th·∫•p (0‚Äì40). Chu·ªói v·∫≠n t·∫£i duy tr√¨ ƒë·ªô ·ªïn ƒë·ªãnh cao, x√°c su·∫•t bi·∫øn c·ªë th·∫•p. C√≥ th·ªÉ t·ªëi ∆∞u th√™m chi ph√≠ ho·∫∑c th·ªùi gian.", medium: "R·ªßi ro trung b√¨nh (40‚Äì70). M·ªôt s·ªë y·∫øu t·ªë v·∫≠n h√†nh ‚Äì th·ªùi ti·∫øt ‚Äì c·∫£ng c√≥ xu h∆∞·ªõng bi·∫øn ƒë·ªông. Doanh nghi·ªáp n√™n theo d√µi s√°t ƒë·ªÉ gi·∫£m thi·ªÉu t·ªïn th·∫•t.", high: "R·ªßi ro cao (70‚Äì100). X√°c su·∫•t s·ª± c·ªë ho·∫∑c ch·∫≠m tr·ªÖ tƒÉng r√µ r·ªát. C·∫ßn ƒë√°nh gi√° l·∫°i tuy·∫øn ƒë∆∞·ªùng, ph∆∞∆°ng th·ª©c v·∫≠n t·∫£i v√† ƒëi·ªÅu ki·ªán cargo."}, reliability_title: "ƒêi·ªÉm ƒê·ªô Tin C·∫≠y", reliability:{very_high: "ƒê·ªô tin c·∫≠y r·∫•t cao (>85). Bi·∫øn ƒë·ªông th·∫•p, m√¥ h√¨nh d·ª± b√°o ·ªïn ƒë·ªãnh. Ph√π h·ª£p c√°c l√¥ h√†ng gi√° tr·ªã l·ªõn.", stable: "·ªîn ƒë·ªãnh (60‚Äì85). H·ªá th·ªëng c√≥ dao ƒë·ªông nh·∫π nh∆∞ng trong gi·ªõi h·∫°n cho ph√©p.", unstable: "Kh√¥ng ·ªïn ƒë·ªãnh (<60). Ho·∫°t ƒë·ªông d·ªÖ ch·ªãu t√°c ƒë·ªông b·ªüi th·ªùi ti·∫øt ho·∫∑c t·∫Øc ngh·∫Ωn. Kh√¥ng khuy·∫øn ngh·ªã v·ªõi h√†ng nh·∫°y c·∫£m th·ªùi gian."}, esg_title: "ƒêi·ªÉm ESG", esg:{strong: "Tu√¢n th·ªß ESG m·∫°nh (>70). Tuy·∫øn v·∫≠n t·∫£i th√¢n thi·ªán m√¥i tr∆∞·ªùng, ph√π h·ª£p c√°c doanh nghi·ªáp ∆∞u ti√™n b·ªÅn v·ªØng.", moderate: "M·ª©c trung b√¨nh (40‚Äì70). Ch∆∞a t·ªëi ∆∞u ESG nh∆∞ng v·∫´n ch·∫•p nh·∫≠n ƒë∆∞·ª£c.", weak: "M·ª©c th·∫•p (<40). R·ªßi ro tu√¢n th·ªß ESG cao. N√™n xem x√©t tuy·∫øn v·∫≠n t·∫£i kh√°c."}}, risk_level_low: "Th·∫•p", risk_level_medium: "Trung B√¨nh", risk_level_high: "Cao", section_radar: "Bi·ªÉu ƒê·ªì Radar H·ªì S∆° R·ªßi Ro", section_layers: "Ph√¢n T√≠ch Ph√¢n L·ªõp R·ªßi Ro", section_montecarlo: "Ph√¢n Ph·ªëi Monte Carlo", section_timeline: "D√≤ng Th·ªùi Gian R·ªßi Ro", section_matrix: "Ma Tr·∫≠n R·ªßi Ro X√°c Su·∫•t √ó T√°c ƒê·ªông", section_scenario: "Ki·ªÉm Tra √Åp L·ª±c K·ªãch B·∫£n (What-if)", section_tradeoff: "ƒê√°nh ƒê·ªïi Chi Ph√≠-Th·ªùi Gian-R·ªßi Ro", section_route: "Ph√¢n T√≠ch Theo C·∫•p ƒê·ªô Tuy·∫øn ƒê∆∞·ªùng", section_recommendations: "Khuy·∫øn Ngh·ªã T·ª´ Chuy√™n Gia AI", section_research_methodology: "T·ªïng Quan Ph∆∞∆°ng Ph√°p Nghi√™n C·ª©u", panel_dataset: "B·∫£ng 1: Gi·∫£i Th√≠ch D·ªØ Li·ªáu", panel_criteria: "B·∫£ng 2: X√¢y D·ª±ng Ti√™u Ch√≠", panel_fuzzy_ahp: "B·∫£ng 3: Ph∆∞∆°ng Ph√°p Fuzzy AHP", panel_fuzzy_topsis: "B·∫£ng 4: Ph√¢n T√≠ch Fuzzy-TOPSIS", panel_montecarlo: "B·∫£ng 5: M√¥ Ph·ªèng Monte Carlo", panel_integrated: "B·∫£ng 6: M√¥ H√¨nh R·ªßi Ro T√≠ch H·ª£p", panel_policy: "B·∫£ng 7: √ù Nghƒ©a Ch√≠nh S√°ch Cho SME Vi·ªát Nam", panel_sensitivity: "B·∫£ng 8: Ki·ªÉm Tra ƒê·ªô Nh·∫°y & ƒê·ªô V·ªØng Ch·∫Øc", section_problem_solution: "V·∫•n ƒê·ªÅ ‚Üí Gi·∫£i Ph√°p ‚Üí T·∫°i Sao B√¢y Gi·ªù", problem_title: "V·∫•n ƒê·ªÅ", solution_title: "Gi·∫£i Ph√°p", why_now_title: "T·∫°i Sao B√¢y Gi·ªù", section_economics: "T√≥m T·∫Øt T√°c ƒê·ªông Kinh T·∫ø", section_arr: "ARR / Ti·ªÅm NƒÉng Doanh Thu", section_architecture: "Ki·∫øn Tr√∫c Engine-as-a-Service", section_pitch: "C√¢u Chuy·ªán M·ªôt Trang Cho Nh√† ƒê·∫ßu T∆∞", investor_ask: "Y√™u C·∫ßu:", scenario_base: "Tr∆∞·ªùng H·ª£p C∆° B·∫£n", scenario_best: "K·ªãch B·∫£n T·ªët Nh·∫•t", scenario_worst: "K·ªãch B·∫£n X·∫•u Nh·∫•t", layer_delay: "R·ªßi Ro Tr·ªÖ", layer_damage: "R·ªßi Ro H∆∞ H·∫°i", layer_cost: "Bi·∫øn ƒê·ªông Chi Ph√≠", layer_operational: "R·ªßi Ro V·∫≠n H√†nh", layer_esg: "R·ªßi Ro ESG", layer_political: "R·ªßi Ro Ch√≠nh Tr·ªã", layer_climate: "R·ªßi Ro Kh√≠ H·∫≠u", based_on_simulations: "D·ª±a tr√™n", simulations: "m√¥ ph·ªèng", days: "ng√†y", usd: "USD", percent: "%", loading: "ƒêang t·∫£i...", no_data: "Kh√¥ng c√≥ d·ªØ li·ªáu", calculating: "ƒêang t√≠nh to√°n...", btn_analyze: "Ch·∫°y Ph√¢n T√≠ch", btn_reset: "ƒê·∫∑t L·∫°i", btn_export: "Xu·∫•t B√°o C√°o", error_no_data: "Kh√¥ng c√≥ d·ªØ li·ªáu. Vui l√≤ng ch·∫°y ph√¢n t√≠ch tr∆∞·ªõc.", error_fetch: "Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ m√°y ch·ªß.", input_transport_mode: "Ph∆∞∆°ng Th·ª©c V·∫≠n T·∫£i", input_cargo_type: "Lo·∫°i H√†ng H√≥a", input_route: "Tuy·∫øn ƒê∆∞·ªùng", input_incoterm: "ƒêi·ªÅu Ki·ªán Incoterm", input_container: "Lo·∫°i Container", input_quality: "Ch·∫•t L∆∞·ª£ng Bao B√¨", input_priority: "Ch·∫ø ƒê·ªô ∆Øu Ti√™n", input_analysis_button: "Ph√¢n T√≠ch R·ªßi Ro", input_transport_placeholder: "Ch·ªçn ph∆∞∆°ng th·ª©c v·∫≠n t·∫£i", placeholder_select: "Ch·ªçn...", placeholder_packages: "Nh·∫≠p s·ªë l∆∞·ª£ng", placeholder_auto: "T·ª± ƒë·ªông t√≠nh to√°n", transport_sea: "ƒê∆∞·ªùng bi·ªÉn", transport_air: "ƒê∆∞·ªùng h√†ng kh√¥ng", transport_road: "ƒê∆∞·ªùng b·ªô", transport_rail: "ƒê∆∞·ªùng s·∫Øt", transport_multimodal: "ƒêa ph∆∞∆°ng th·ª©c", transport_intermodal: "Li√™n h·ª£p v·∫≠n t·∫£i", transport_express: "Chuy·ªÉn ph√°t nhanh", transport_postal: "B∆∞u ki·ªán qu·ªëc t·∫ø", transport_pipeline: "ƒê∆∞·ªùng ·ªëng", transport_inland: "ƒê∆∞·ªùng th·ªßy n·ªôi ƒë·ªãa", transport_roro: "V·∫≠n t·∫£i Ro-Ro", transport_mode: "Ph∆∞∆°ng th·ª©c v·∫≠n t·∫£i", cargo_type: "Lo·∫°i h√†ng h√≥a", route: "Tuy·∫øn ƒë∆∞·ªùng", incoterm: "ƒêi·ªÅu ki·ªán Incoterm", container: "Lo·∫°i container", packaging: "Ch·∫•t l∆∞·ª£ng bao b√¨", priority: "Ch·∫ø ƒë·ªô ∆∞u ti√™n", section1_title: "C·∫•u H√¨nh H√†ng H√≥a", section1_subtitle: "D·ªØ li·ªáu n·ªÅn ƒë·ªÉ AI t·ªëi ∆∞u l·ªô tr√¨nh, th·ªùi gian v√† r·ªßi ro theo t·ª´ng khu v·ª±c v·∫≠n chuy·ªÉn.", section2_title: "Th√¥ng Tin V·∫≠n Chuy·ªÉn", section2_subtitle: "Chi ti·∫øt tuy·∫øn ƒë∆∞·ªùng v√† ƒëi·ªÅu ki·ªán giao h√†ng", section3_title: "Th√¥ng S·ªë B·ªï Sung", section3_subtitle: "C√°c y·∫øu t·ªë ·∫£nh h∆∞·ªüng ƒë·∫øn r·ªßi ro", status_ready: "H·ªá Th·ªëng S·∫µn S√†ng", loading_text: "ƒêang kh·ªüi t·∫°o Risk Engine...", label_transport_mode: "Ph∆∞∆°ng Th·ª©c V·∫≠n T·∫£i", label_cargo_type: "Lo·∫°i H√†ng H√≥a", label_route: "Tuy·∫øn ƒê∆∞·ªùng", label_incoterm: "ƒêi·ªÅu Ki·ªán Incoterm", label_container: "Lo·∫°i Container", label_packaging: "Ch·∫•t L∆∞·ª£ng Bao B√¨", label_priority: "Ch·∫ø ƒê·ªô ∆Øu Ti√™n", label_packages: "S·ªë L∆∞·ª£ng Ki·ªán H√†ng", label_etd: "Ng√†y G·ª≠i H√†ng D·ª± Ki·∫øn (ETD)", label_eta: "Ng√†y ƒê·∫øn D·ª± Ki·∫øn (ETA)", label_cargo_value: "Gi√° Tr·ªã H√†ng H√≥a (USD)", opt_tm_ocean_fcl: "V·∫≠n T·∫£i Bi·ªÉn ‚Äî FCL", opt_tm_ocean_lcl: "V·∫≠n T·∫£i Bi·ªÉn ‚Äî LCL", opt_tm_air: "V·∫≠n T·∫£i H√†ng Kh√¥ng", opt_tm_rail: "V·∫≠n T·∫£i ƒê∆∞·ªùng S·∫Øt", opt_tm_road: "ƒê∆∞·ªùng B·ªô ‚Äî Xe T·∫£i", opt_tm_multimodal: "V·∫≠n T·∫£i ƒêa Ph∆∞∆°ng Th·ª©c", opt_tm_courier: "Chuy·ªÉn Ph√°t Nhanh / Express", opt_tm_inland: "ƒê∆∞·ªùng Th·ªßy N·ªôi ƒê·ªãa", opt_tm_pipeline: "ƒê∆∞·ªùng ·ªêng", opt_tm_cross: "ƒê∆∞·ªùng B·ªô Xuy√™n Bi√™n Gi·ªõi", opt_tm_lastmile: "Giao H√†ng Cu·ªëi D·∫∑m", error_required: "Tr∆∞·ªùng n√†y l√† b·∫Øt bu·ªôc", error_positive: "Gi√° tr·ªã ph·∫£i l√† s·ªë d∆∞∆°ng", error_date_invalid: "Ng√†y kh√¥ng h·ª£p l·ªá", confirm_reset: "B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒë·∫∑t l·∫°i t·∫•t c·∫£ c√°c tr∆∞·ªùng?", alert_success: "Ph√¢n t√≠ch r·ªßi ro ho√†n t·∫•t th√†nh c√¥ng!", buyer_section: "Th√¥ng tin Ng∆∞·ªùi Mua (Buyer)", buyer_name: "T√™n ng∆∞·ªùi mua", buyer_country: "Qu·ªëc gia ng∆∞·ªùi mua", buyer_size: "Quy m√¥ doanh nghi·ªáp", buyer_esg: "ƒêi·ªÉm ESG (n·∫øu c√≥)", buyer_reliability: "ƒêi·ªÉm uy t√≠n (Reliability)", seller_section: "Th√¥ng tin Ng∆∞·ªùi B√°n (Seller)", seller_name: "T√™n ng∆∞·ªùi b√°n", seller_country: "Qu·ªëc gia ng∆∞·ªùi b√°n", seller_size: "Quy m√¥ doanh nghi·ªáp", seller_esg: "ƒêi·ªÉm ESG (n·∫øu c√≥)", seller_reliability: "ƒêi·ªÉm uy t√≠n (Reliability)", country_vn: "Vi·ªát Nam", country_cn: "Trung Qu·ªëc", country_jp: "Nh·∫≠t B·∫£n", country_kr: "H√†n Qu·ªëc", country_us: "Hoa K·ª≥", country_eu: "Li√™n Minh Ch√¢u √Çu", company_sme: "SME (10‚Äì200 lao ƒë·ªông)", company_medium: "Trung b√¨nh (200‚Äì500)", company_large: "L·ªõn (>500)", opt_ct_general: "H√†ng H√≥a Th√¥ng Th∆∞·ªùng", opt_ct_electronics: "ƒêi·ªán T·ª≠", opt_ct_food_bev: "Th·ª±c Ph·∫©m & ƒê·ªì U·ªëng", opt_ct_garments: "May M·∫∑c / D·ªát May", opt_ct_agriculture: "N√¥ng S·∫£n", opt_ct_refrigerated: "H√†ng L·∫°nh / ƒê√¥ng L·∫°nh", opt_ct_chemicals: "H√≥a Ch·∫•t", opt_ct_machinery: "M√°y M√≥c Thi·∫øt B·ªã", opt_ct_fragile: "H√†ng D·ªÖ V·ª°", opt_ct_auto_parts: "Linh Ki·ªán √î T√¥", opt_vn_us: "Vi·ªát Nam ‚Üí Hoa K·ª≥", opt_vn_eu: "Vi·ªát Nam ‚Üí Ch√¢u √Çu", opt_vn_cn: "Vi·ªát Nam ‚Üí Trung Qu·ªëc", opt_vn_sg: "Vi·ªát Nam ‚Üí Singapore", opt_domestic: "N·ªôi ƒê·ªãa", opt_ic_exw: "EXW", opt_ic_fca: "FCA", opt_ic_fas: "FAS", opt_ic_fob: "FOB", opt_ic_cfr: "CFR", opt_ic_cif: "CIF", opt_ic_cpt: "CPT", opt_ic_cip: "CIP", opt_ic_dap: "DAP", opt_ic_dpu: "DPU", opt_ic_ddp: "DDP", opt_cn_20ft: "20ft Th∆∞·ªùng", opt_cn_40ft: "40ft Th∆∞·ªùng", opt_cn_40hc: "40ft Cao (High Cube)", opt_cn_45hc: "45ft Cao (High Cube)", opt_cn_reefer: "Container L·∫°nh (Reefer)", opt_cn_opentop: "Container M·ªü N√≥c (Open-top)", opt_cn_flatrack: "Flat-rack (S√†n Ph·∫≥ng)", opt_cn_isotank: "ISO Tank", opt_pk_poor: "K√©m", opt_pk_medium: "Trung B√¨nh", opt_pk_good: "T·ªët", opt_pk_excellent: "Xu·∫•t S·∫Øc", label_climate_tail_prob: "X√°c Su·∫•t S·ª± Ki·ªán Kh√≠ H·∫≠u C·ª±c ƒêoan", opt_pr_economy: "Ti·∫øt Ki·ªám (Economy)", opt_pr_standard: "Ti√™u Chu·∫©n (Standard)", opt_pr_express: "H·ªèa T·ªëc (Express)", opt_pr_critical: "C·∫•p B√°ch (Critical)", section_buyer_seller: "Ng∆∞·ªùi Mua & Ng∆∞·ªùi B√°n", section_buyer_seller_subtitle: "Th√¥ng tin ƒë·ªëi t√°c th∆∞∆°ng m·∫°i", label_transit_time: "Th·ªùi Gian V·∫≠n Chuy·ªÉn", suffix_days: "ng√†y", suffix_units: "ƒë∆°n v·ªã", module_fuzzy_title: "Fuzzy AHP", module_fuzzy_desc: "Ph√¢n t√≠ch quy·∫øt ƒë·ªãnh ƒëa ti√™u ch√≠", module_arima_title: "D·ª± B√°o ARIMA", module_arima_desc: "M√¥ h√¨nh d·ª± ƒëo√°n chu·ªói th·ªùi gian", module_mc_title: "Monte Carlo", module_mc_desc: "C√¥ng c·ª• m√¥ ph·ªèng ng·∫´u nhi√™n", module_var_title: "VaR / CVaR", module_var_desc: "ƒê·ªãnh l∆∞·ª£ng r·ªßi ro c·ª±c ƒëoan"};const TRANSLATIONS_EN ={brand_title: "RISKCAST v12.5", brand_subtitle: "AI-Powered Logistics Risk Intelligence Platform", status_ready: "Analysis Complete", status_loading: "Loading data...", tab_enterprise: "Enterprise Dashboard", tab_research: "Research / NCKH View", tab_investor: "Investor Pitch View", section_executive: "Executive Snapshot", label_overall_risk: "Overall Risk Index", label_expected_loss: "Expected Loss", label_reliability: "Delivery Reliability", label_esg: "ESG Score (Environment ‚Äì Social ‚Äì Governance)", subtitle_per_shipment: "Per shipment", subtitle_on_time_prob: "On-time probability", subtitle_climate_political: "Climate + Political", label_top_route: "Top Route Risk:", label_main_driver: "Main Driver:", label_recommendation: "System Recommendation:", section_risk_gauges: "Risk Gauges Overview", gauge_risk_title: "Overall Risk Index", gauge_reliability_title: "Reliability Score", gauge_esg_title: "ESG Score", gauge_explanations:{title: "Detailed Insights", risk_title: "Overall Risk Index", risk:{low: "Low risk (0‚Äì40). The logistics flow is stable with minimal disruption probability. Suitable for cost/time optimization.", medium: "Moderate risk (40‚Äì70). Certain operational or weather-driven fluctuations are emerging. Active monitoring required.", high: "High risk (70‚Äì100). Elevated probability of delays or incidents. Route reassessment and mitigation actions recommended."}, reliability_title: "Reliability Score", reliability:{very_high: "Very high reliability (>85). Strong predictive stability;ideal for high-value shipments.", stable: "Stable (60‚Äì85). Acceptable variations within control limits.", unstable: "Unstable (<60). Sensitive to disruptions. Not ideal for time-critical cargo."}, esg_title: "ESG Score", esg:{strong: "Strong ESG compliance (>70). Environmentally aligned route, suitable for sustainability-focused businesses.", moderate: "Moderate ESG performance (40‚Äì70). Acceptable but not optimized.", weak: "Weak ESG compliance (<40). Elevated ESG risk;alternative routing recommended."}}, risk_level_low: "Low", risk_level_medium: "Medium", risk_level_high: "High", section_radar: "Risk Profile Radar Chart", section_layers: "Risk Layer Decomposition", section_montecarlo: "Monte Carlo Distribution", section_timeline: "Risk Timeline", section_matrix: "Probability √ó Impact Risk Matrix", section_scenario: "Scenario Stress Test (What-if)", section_tradeoff: "Cost-Time-Risk Tradeoff", section_route: "Route Segment Analysis", section_recommendations: "AI Expert Recommendations", section_research_methodology: "Research Methodology Overview", panel_dataset: "Panel 1: Dataset Interpretation", panel_criteria: "Panel 2: Criteria Construction", panel_fuzzy_ahp: "Panel 3: Fuzzy AHP Methodology", panel_fuzzy_topsis: "Panel 4: Fuzzy-TOPSIS Analysis", panel_montecarlo: "Panel 5: Monte Carlo Simulation", panel_integrated: "Panel 6: Integrated Risk Model", panel_policy: "Panel 7: Policy Implications for Vietnamese SMEs", panel_sensitivity: "Panel 8: Sensitivity & Robustness Check", section_problem_solution: "Problem ‚Üí Solution ‚Üí Why Now", problem_title: "Problem", solution_title: "Solution", why_now_title: "Why Now", section_economics: "Economics Snapshot", section_arr: "ARR / Revenue Potential", section_architecture: "Engine-as-a-Service Architecture", section_pitch: "One-Slide Story for Investors", investor_ask: "The Ask:", scenario_base: "Base Case", scenario_best: "Best Case", scenario_worst: "Worst Case", layer_delay: "Delay Risk", layer_damage: "Damage Risk", layer_cost: "Cost Volatility", layer_operational: "Operational Risk", layer_esg: "ESG Risk", layer_political: "Political Risk", layer_climate: "Climate Risk", based_on_simulations: "Based on", simulations: "simulations", days: "days", usd: "USD", percent: "%", loading: "Loading...", no_data: "No data available", calculating: "Calculating...", btn_analyze: "Run Analysis", btn_reset: "Reset", btn_export: "Export Report", error_no_data: "No data available. Please run analysis first.", error_fetch: "Failed to fetch data from server.", input_transport_mode: "Transport Mode", input_cargo_type: "Cargo Type", input_route: "Route", input_incoterm: "Incoterm Condition", input_container: "Container Type", input_quality: "Packaging Quality", input_priority: "Priority Mode", input_analysis_button: "Run Risk Analysis", input_transport_placeholder: "Select transport mode", placeholder_select: "Select...", placeholder_packages: "Enter quantity", placeholder_auto: "Auto-calculated", section1_title: "Cargo Configuration", section1_subtitle: "Background data for AI to optimize routes, time and risks by shipping region.", section2_title: "Shipping Information", section2_subtitle: "Route details and delivery conditions", section3_title: "Additional Parameters", section3_subtitle: "Factors affecting risk", status_ready: "System Ready", loading_text: "Initializing Risk Engine...", label_transport_mode: "Transport Mode", label_cargo_type: "Cargo Type", label_route: "Route", label_incoterm: "Incoterm Condition", label_container: "Container Type", label_packaging: "Packaging Quality", label_priority: "Priority Mode", label_packages: "Number of Packages", label_etd: "Expected Departure Date (ETD)", label_eta: "Expected Arrival Date (ETA)", label_cargo_value: "Cargo Value (USD)", transport_sea: "Sea Freight", transport_air: "Air Freight", transport_road: "Road Transport", transport_rail: "Rail Transport", transport_multimodal: "Multimodal Transport", transport_intermodal: "Intermodal Transport", transport_express: "Courier / Express", transport_postal: "International Postal / Parcel", transport_pipeline: "Pipeline Transport", transport_inland: "Inland Waterway", transport_roro: "Ro-Ro Transport", opt_tm_ocean_fcl: "Ocean Freight ‚Äî FCL", opt_tm_ocean_lcl: "Ocean Freight ‚Äî LCL", opt_tm_air: "Air Freight", opt_tm_rail: "Rail Freight", opt_tm_road: "Road ‚Äî Truck", opt_tm_multimodal: "Multimodal Transport", opt_tm_courier: "Courier / Express", opt_tm_inland: "Inland Waterway", opt_tm_pipeline: "Pipeline", opt_tm_cross: "Cross-border Road", opt_tm_lastmile: "Last-mile Delivery", error_required: "This field is required", error_positive: "Value must be a positive number", error_date_invalid: "Invalid date", confirm_reset: "Are you sure you want to reset all fields?", alert_success: "Risk analysis completed successfully!", buyer_section: "Buyer Information", buyer_name: "Buyer Name", buyer_country: "Buyer Country", buyer_size: "Company Size", buyer_esg: "ESG Score (if available)", buyer_reliability: "Reliability Score", seller_section: "Seller Information", seller_name: "Seller Name", seller_country: "Seller Country", seller_size: "Company Size", seller_esg: "ESG Score (if available)", seller_reliability: "Reliability Score", country_vn: "Vietnam", country_cn: "China", country_jp: "Japan", country_kr: "South Korea", country_us: "United States", country_eu: "European Union", company_sme: "SME (10‚Äì200 employees)", company_medium: "Medium (200‚Äì500)", company_large: "Large (>500)", opt_ct_general: "General Cargo", opt_ct_electronics: "Electronics", opt_ct_food_bev: "Food & Beverage", opt_ct_garments: "Garments / Textile", opt_ct_agriculture: "Agriculture", opt_ct_refrigerated: "Refrigerated / Frozen", opt_ct_chemicals: "Chemicals", opt_ct_machinery: "Machinery", opt_ct_fragile: "Fragile Goods", opt_ct_auto_parts: "Automotive Parts", opt_vn_us: "Vietnam ‚Üí United States", opt_vn_eu: "Vietnam ‚Üí Europe", opt_vn_cn: "Vietnam ‚Üí China", opt_vn_sg: "Vietnam ‚Üí Singapore", opt_domestic: "Domestic", opt_ic_exw: "EXW", opt_ic_fca: "FCA", opt_ic_fas: "FAS", opt_ic_fob: "FOB", opt_ic_cfr: "CFR", opt_ic_cif: "CIF", opt_ic_cpt: "CPT", opt_ic_cip: "CIP", opt_ic_dap: "DAP", opt_ic_dpu: "DPU", opt_ic_ddp: "DDP", opt_cn_20ft: "20ft Standard", opt_cn_40ft: "40ft Standard", opt_cn_40hc: "40ft High Cube", opt_cn_45hc: "45ft High Cube", opt_cn_reefer: "Reefer Container", opt_cn_opentop: "Open-top", opt_cn_flatrack: "Flat-rack", opt_cn_isotank: "ISO Tank", opt_pk_poor: "Poor", opt_pk_medium: "Medium", opt_pk_good: "Good", opt_pk_excellent: "Excellent", label_climate_tail_prob: "Climate Tail Event Probability", opt_pr_economy: "Economy", opt_pr_standard: "Standard", opt_pr_express: "Express", opt_pr_critical: "Critical", section_buyer_seller: "Buyer & Seller", section_buyer_seller_subtitle: "Trading partner information", label_transit_time: "Transit Time", suffix_days: "days", suffix_units: "units", module_fuzzy_title: "Fuzzy AHP", module_fuzzy_desc: "Multi-criteria decision analysis", module_arima_title: "ARIMA Forecasting", module_arima_desc: "Time series prediction model", module_mc_title: "Monte Carlo", module_mc_desc: "Stochastic simulation engine", module_var_title: "VaR / CVaR", module_var_desc: "Extreme risk quantification"};let currentLang = localStorage.getItem('riskcast_lang') || 'vi';function getTranslations(){if (currentLang === 'en'){return TRANSLATIONS_EN;}else{return TRANSLATIONS_VI;}}let translationCache ={dataLang: null, dataI18n: null, dropdownItems: null, dropdownSelected: null, dropdownWrappers: null, dataPlaceholder: null, dropdownValue: null, cardTitles: null, cardBadges: null, langButtons: null, tabButtons: null, cached: false};function buildTranslationCache(){if (translationCache.cached) return;translationCache.dataLang = Array.from(document.querySelectorAll('[data-lang]'));translationCache.dataI18n = Array.from(document.querySelectorAll('[data-i18n]'));translationCache.dropdownItems = Array.from(document.querySelectorAll(".dropdown-item"));translationCache.dropdownSelected = Array.from(document.querySelectorAll(".dropdown-selected.placeholder"));translationCache.dropdownWrappers = Array.from(document.querySelectorAll('.dropdown-wrapper .dropdown'));translationCache.dataPlaceholder = Array.from(document.querySelectorAll('[data-placeholder]'));translationCache.dropdownValue = Array.from(document.querySelectorAll('.dropdown-value.placeholder'));translationCache.cardTitles = Array.from(document.querySelectorAll('.card-title span[data-lang]'));translationCache.cardBadges = Array.from(document.querySelectorAll('.card-badge[data-lang]'));translationCache.langButtons = Array.from(document.querySelectorAll('.lang-btn'));translationCache.tabButtons ={enterprise: document.querySelector('#tab-enterprise span[data-lang="tab_enterprise"]'), research: document.querySelector('#tab-research span[data-lang="tab_research"]'), investor: document.querySelector('#tab-investor span[data-lang="tab_investor"]')};translationCache.cached = true;}function clearTranslationCache(){translationCache.cached = false;translationCache.dataLang = null;translationCache.dataI18n = null;translationCache.dropdownItems = null;translationCache.dropdownSelected = null;translationCache.dropdownWrappers = null;translationCache.dataPlaceholder = null;translationCache.dropdownValue = null;translationCache.cardTitles = null;translationCache.cardBadges = null;translationCache.langButtons = null;translationCache.tabButtons = null;}function applyLanguage(){const t = getTranslations();buildTranslationCache();translationCache.dataLang.forEach(el =>{const key = el.getAttribute('data-lang');if (t[key]){if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA'){el.placeholder = t[key];}else{el.textContent = t[key];}}});translationCache.dataI18n.forEach(el =>{const key = el.getAttribute('data-i18n');if (t[key]){if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA'){el.placeholder = t[key];}else{el.textContent = t[key];}}});translationCache.dropdownItems.forEach(item =>{const key = item.getAttribute('data-i18n');if (key && t[key]){item.textContent = t[key];}});translationCache.dropdownSelected.forEach(sel =>{const key = sel.getAttribute('data-i18n');if (key && t[key]){sel.textContent = t[key];}});translationCache.dropdownWrappers.forEach(dropdown =>{const selected = dropdown.querySelector('.dropdown-selected');if (selected && selected.dataset.value && !selected.classList.contains('placeholder')){const value = selected.dataset.value;const item = dropdown.querySelector(`.dropdown-item[data-value="${value}"]`);if (item){const key = item.getAttribute('data-i18n');if (key && t[key]){selected.textContent = t[key];}}}});translationCache.dataPlaceholder.forEach(el =>{const key = el.getAttribute('data-placeholder');if (t[key]){el.placeholder = t[key];}});translationCache.dropdownValue.forEach(el =>{const key = el.getAttribute('data-lang') || el.getAttribute('data-i18n');if (key && t[key]){el.textContent = t[key];}else if (t.placeholder_select){el.textContent = t.placeholder_select;}});const tabs = translationCache.tabButtons;if (tabs.enterprise && t.tab_enterprise) tabs.enterprise.textContent = t.tab_enterprise;if (tabs.research && t.tab_research) tabs.research.textContent = t.tab_research;if (tabs.investor && t.tab_investor) tabs.investor.textContent = t.tab_investor;translationCache.cardTitles.forEach(el =>{const key = el.getAttribute('data-lang');if (t[key]){el.textContent = t[key];}});translationCache.cardBadges.forEach(el =>{const key = el.getAttribute('data-lang');if (t[key]){el.textContent = t[key];}});}function setLanguage(lang){if (lang === 'vi' || lang === 'en'){currentLang = lang;localStorage.setItem('riskcast_lang', lang);applyLanguage();updateLanguageButtons();if (window.RISKCAST?.pages?.results?.renderGaugeExplanation && window.appData){window.RISKCAST.pages.results.renderGaugeExplanation(window.appData);}if (window.RISKCAST?.pages?.results?.renderGaugeCharts && window.appData?.summary){window.RISKCAST.pages.results.renderGaugeCharts(window.appData.summary);}}}function updateLanguageButtons(){buildTranslationCache();translationCache.langButtons.forEach(btn =>{const btnLang = btn.getAttribute('data-lang');if (btnLang === currentLang){btn.classList.add('active');}else{btn.classList.remove('active');}});const btnVI = document.getElementById('lang-btn-vi') || document.getElementById('btn-lang-vi');const btnEN = document.getElementById('lang-btn-en') || document.getElementById('btn-lang-en');if (btnVI){if (currentLang === 'vi'){btnVI.classList.add('active');}else{btnVI.classList.remove('active');}}if (btnEN){if (currentLang === 'en'){btnEN.classList.add('active');}else{btnEN.classList.remove('active');}}}function initializeLanguage(){buildTranslationCache();translationCache.langButtons.forEach(btn =>{btn.addEventListener('click', function(){const lang = this.getAttribute('data-lang');setLanguage(lang);});});const btnVI = document.getElementById('lang-btn-vi') || document.getElementById('btn-lang-vi');const btnEN = document.getElementById('lang-btn-en') || document.getElementById('btn-lang-en');if (btnVI){btnVI.addEventListener('click', () => setLanguage('vi'));}if (btnEN){btnEN.addEventListener('click', () => setLanguage('en'));}applyLanguage();updateLanguageButtons();}if (document.readyState === 'loading'){document.addEventListener('DOMContentLoaded', initializeLanguage);}else{initializeLanguage();}window.RISKCAST.core.translations ={TRANSLATIONS_VI: TRANSLATIONS_VI, TRANSLATIONS_EN: TRANSLATIONS_EN, setLanguage: setLanguage, applyLanguage: applyLanguage, getCurrentLang: () => currentLang, getTranslations: getTranslations, initialize: initializeLanguage, clearCache: clearTranslationCache, get: (key) =>{const t = getTranslations();return t[key] || key;}};window.TRANSLATIONS_VI = TRANSLATIONS_VI;window.TRANSLATIONS_EN = TRANSLATIONS_EN;window.RiskcastLang = window.RISKCAST.core.translations;})();class StreamingHandler{constructor(containerId){this.container = document.getElementById(containerId);this.currentText = '';this.isStreaming = false;this.abortController = null;this.updateBuffer = '';this.updateScheduled = false;this.lastUpdateTime = 0;this.animationFrameId = null;}async stream(endpoint, payload){if (this.isStreaming){this.stop();}this.isStreaming = true;this.currentText = '';this.abortController = new AbortController();const messageDiv = document.createElement('div');messageDiv.className = 'ai-message assistant';messageDiv.innerHTML = ` <div class="ai-message-avatar">ü§ñ</div> <div class="ai-message-content"> <div class="ai-streaming"> <div class="ai-streaming-text"></div> <span class="ai-typing-cursor"></span> </div> </div> `;this.container.appendChild(messageDiv);const textElement = messageDiv.querySelector('.ai-streaming-text');try{const response = await fetch(endpoint,{method: 'POST', headers:{'Content-Type': 'application/json',}, body: JSON.stringify(payload), signal: this.abortController.signal});if (!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const reader = response.body.getReader();const decoder = new TextDecoder();while (true){const{done, value}= await reader.read();if (done){if (this.updateScheduled){this.flushBatchUpdate(textElement);}const cursor = messageDiv.querySelector('.ai-typing-cursor');if (cursor) cursor.remove();break;}const chunk = decoder.decode(value,{stream: true});const lines = chunk.split('\n');for (const line of lines){if (line.startsWith('data: ')){const data = line.slice(6);if (data === '[DONE]'){if (this.updateScheduled){this.flushBatchUpdate(textElement);}const cursor = messageDiv.querySelector('.ai-typing-cursor');if (cursor) cursor.remove();this.isStreaming = false;return;}try{const parsed = JSON.parse(data);if (parsed.text){this.currentText += parsed.text;this.scheduleBatchUpdate(textElement);}}catch (e){}}}}}catch (error){if (error.name === 'AbortError'){}else{console.error('Streaming error:', error);textElement.textContent = this.currentText + '\n\n[Error: ' + error.message + ']';}}finally{this.isStreaming = false;}}scheduleBatchUpdate(textElement){if (!this.updateScheduled){this.updateScheduled = true;if (this.animationFrameId){cancelAnimationFrame(this.animationFrameId);}this.animationFrameId = requestAnimationFrame(() =>{this.flushBatchUpdate(textElement);});}}flushBatchUpdate(textElement){const now = performance.now();if (now - this.lastUpdateTime >= 16 || this.currentText.length - this.updateBuffer.length > 50){textElement.textContent = this.currentText;this.updateBuffer = this.currentText;this.lastUpdateTime = now;this.container.scrollTop = this.container.scrollHeight;}this.updateScheduled = false;this.animationFrameId = null;}stop(){if (this.abortController){this.abortController.abort();this.abortController = null;}if (this.animationFrameId){cancelAnimationFrame(this.animationFrameId);this.animationFrameId = null;}this.isStreaming = false;this.updateScheduled = false;}appendText(text, isUser = false){const messageDiv = document.createElement('div');messageDiv.className = `ai-message ${isUser ? 'user' : 'assistant'}`;messageDiv.innerHTML = ` <div class="ai-message-avatar">${isUser ? 'üë§' : 'ü§ñ'}</div> <div class="ai-message-content">${this.escapeHtml(text)}</div> `;this.container.appendChild(messageDiv);this.container.scrollTop = this.container.scrollHeight;}showLoading(){const loadingDiv = document.createElement('div');loadingDiv.className = 'ai-message assistant';loadingDiv.id = 'ai-loading-indicator';loadingDiv.innerHTML = ` <div class="ai-message-avatar">ü§ñ</div> <div class="ai-message-content"> <div class="ai-loading"> <div class="ai-loading-dot"></div> <div class="ai-loading-dot"></div> <div class="ai-loading-dot"></div> </div> </div> `;this.container.appendChild(loadingDiv);this.container.scrollTop = this.container.scrollHeight;}hideLoading(){const loading = document.getElementById('ai-loading-indicator');if (loading){loading.remove();}}clear(){this.container.innerHTML = '';this.currentText = '';}escapeHtml(text){const div = document.createElement('div');div.textContent = text;return div.innerHTML;}}if (typeof module !== 'undefined' && module.exports){module.exports = StreamingHandler;}